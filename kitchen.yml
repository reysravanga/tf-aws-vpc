---
driver:
  name: terraform
provisioner:
  name: terraform
verifier:
  name: terraform

platforms:
  - name: local
    driver:
      root_module_directory: test/fixtures/default
      variables:
        aws_region: <%= ENV['AWS_REGION'] %>
      variable_files:
        - test/fixtures/default/default.tfvars
    verifier:
      systems:
        - name: local
          backend: local
          controls:
            - state_file
            - terraform_output
  - name: aws
    driver:
      root_module_directory: test/fixtures/default
      variables:
        aws_region: <%= ENV['AWS_REGION'] %>
      variable_files:
        - test/fixtures/default/default.tfvars
    verifier:
      systems:
        - name: aws
          backend: aws
          attrs_outputs:
            aws_vpc_id: vpc_id
            variable_output_filename: variable_output_filename
          controls:
            - aws_vpc

suites:
  - name: local
    includes:
      - local
  - name: aws
    includes:
      - aws
